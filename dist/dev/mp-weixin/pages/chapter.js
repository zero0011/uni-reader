(global["webpackJsonp"] = global["webpackJsonp"] || []).push([["pages/chapter"],{

/***/ 301:
/*!************************************************!*\
  !*** ./src/main.js?{"page":"pages%2Fchapter"} ***!
  \************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(wx, createPage) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
__webpack_require__(/*! uni-pages */ 26);
var _vue = _interopRequireDefault(__webpack_require__(/*! vue */ 25));
var _chapter = _interopRequireDefault(__webpack_require__(/*! ./pages/chapter.vue */ 302));
// @ts-ignore
wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;
createPage(_chapter.default);
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/wx.js */ 1)["default"], __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */ 2)["createPage"]))

/***/ }),

/***/ 302:
/*!*******************************!*\
  !*** ./src/pages/chapter.vue ***!
  \*******************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./chapter.vue?vue&type=template&id=11aa2564&scoped=true& */ 303);
/* harmony import */ var _chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./chapter.vue?vue&type=script&lang=js& */ 305);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__[key]; }) }(__WEBPACK_IMPORT_KEY__));
/* harmony import */ var _chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./chapter.vue?vue&type=style&index=0&id=11aa2564&lang=scss&scoped=true& */ 309);
/* harmony import */ var _node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */ 32);

var renderjs





/* normalize component */

var component = Object(_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_runtime_componentNormalizer_js__WEBPACK_IMPORTED_MODULE_3__["default"])(
  _chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_1__["default"],
  _chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"],
  _chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"],
  false,
  null,
  "11aa2564",
  null,
  false,
  _chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"],
  renderjs
)

component.options.__file = "pages/chapter.vue"
/* harmony default export */ __webpack_exports__["default"] = (component.exports);

/***/ }),

/***/ 303:
/*!**************************************************************************!*\
  !*** ./src/pages/chapter.vue?vue&type=template&id=11aa2564&scoped=true& ***!
  \**************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chapter.vue?vue&type=template&id=11aa2564&scoped=true& */ 304);
/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "render", function() { return _node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["render"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return _node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["staticRenderFns"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return _node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["recyclableRender"]; });

/* harmony reexport (safe) */ __webpack_require__.d(__webpack_exports__, "components", function() { return _node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_templateLoader_js_vue_loader_options_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_15_0_node_modules_dcloudio_webpack_uni_mp_loader_lib_template_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_uni_app_loader_page_meta_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_template_id_11aa2564_scoped_true___WEBPACK_IMPORTED_MODULE_0__["components"]; });



/***/ }),

/***/ 304:
/*!**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--15-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/pages/chapter.vue?vue&type=template&id=11aa2564&scoped=true& ***!
  \**************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "render", function() { return render; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "staticRenderFns", function() { return staticRenderFns; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "recyclableRender", function() { return recyclableRender; });
/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "components", function() { return components; });
var components
var render = function () {
  var _vm = this
  var _h = _vm.$createElement
  var _c = _vm._self._c || _h
}
var recyclableRender = false
var staticRenderFns = []
render._withStripped = true



/***/ }),

/***/ 305:
/*!********************************************************!*\
  !*** ./src/pages/chapter.vue?vue&type=script&lang=js& ***!
  \********************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../node_modules/babel-loader/lib!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chapter.vue?vue&type=script&lang=js& */ 306);
/* harmony import */ var _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_node_modules_babel_loader_lib_index_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_13_1_node_modules_dcloudio_webpack_uni_mp_loader_lib_script_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_script_lang_js___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 306:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--13-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/pages/chapter.vue?vue&type=script&lang=js& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

"use strict";
/* WEBPACK VAR INJECTION */(function(wx) {

var _interopRequireDefault = __webpack_require__(/*! @babel/runtime/helpers/interopRequireDefault */ 4);
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _defineProperty2 = _interopRequireDefault(__webpack_require__(/*! @babel/runtime/helpers/defineProperty */ 11));
var _store = _interopRequireDefault(__webpack_require__(/*! @/store */ 48));
var _isEqual = _interopRequireDefault(__webpack_require__(/*! lodash/isEqual */ 307));
var _chunk2 = _interopRequireDefault(__webpack_require__(/*! lodash/chunk */ 308));
var _get2 = _interopRequireDefault(__webpack_require__(/*! lodash/get */ 157));
var _constants = __webpack_require__(/*! @/utils/constants */ 181);
var _utils = __webpack_require__(/*! @/utils */ 46);
function ownKeys(e, r) { var t = Object.keys(e); if (Object.getOwnPropertySymbols) { var o = Object.getOwnPropertySymbols(e); r && (o = o.filter(function (r) { return Object.getOwnPropertyDescriptor(e, r).enumerable; })), t.push.apply(t, o); } return t; }
function _objectSpread(e) { for (var r = 1; r < arguments.length; r++) { var t = null != arguments[r] ? arguments[r] : {}; r % 2 ? ownKeys(Object(t), !0).forEach(function (r) { (0, _defineProperty2.default)(e, r, t[r]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(e, Object.getOwnPropertyDescriptors(t)) : ownKeys(Object(t)).forEach(function (r) { Object.defineProperty(e, r, Object.getOwnPropertyDescriptor(t, r)); }); } return e; } //
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
//
// /pages/chapter/main?from=share&bookId=${书籍ID}&sourceId=${书源ID}&chapterIndex=${章节号}
// 临时变量,书源
var _currentSource = null;
// 临时变量,保存页面onHide之前的数据，与onShow之后做对比，如果一直就不重新获取
var _lastChapter = null;
// 保存章节数据，不放在data中，防止数据过大，造成卡顿
var _chapterListData = {
  chapters: []
};
// 保存章节分段数据
var _chaptersSection = [];
var _default = exports.default = {
  data: function data() {
    return {
      CHAPTER_SECTION_COUNT: _constants.CHAPTER_SECTION_COUNT,
      fromOtherPlace: false,
      // 是否从其他地方跳转过来
      showDirectory: false,
      // 是否展示目录
      showFooterBar: false,
      // 是否展示底部菜单
      isNightMode: false,
      // 是否是夜间模式
      currentPageIndex: 0,
      // 当前查看第几章
      bookInBookCase: null,
      // 书籍对应的书架的内容
      lightness: 0,
      // 亮度
      showSettingPanel: false,
      // 是否展示设置面板
      chapterFontSize: 14,
      // 默认字体大小
      isKeepLight: false,
      // 屏幕是否保持常亮
      currentChapterSectionIndex: 0,
      // 当前处在章节分段第几段
      chapterListDataId: 0,
      // 章节ID
      chaptersSectionCount: 0,
      // 章节数量
      currentChapterSection: [] // 当前查看的章节段落
    };
  },
  computed: {
    // 书架内容
    bookCase: function bookCase() {
      return _store.default.state.bookCase;
    },
    // 书籍详情
    bookDetails: function bookDetails() {
      return _store.default.state.bookDetails;
    },
    // 书籍对应的书架的内容
    bookInBookCase: function bookInBookCase() {
      var bookId = this.$root.$mp.query.bookId;
      return this.bookCase.find(function (book) {
        return book._id === bookId;
      });
    },
    // 书源
    sourceList: function sourceList() {
      return _store.default.state.sourceList;
    },
    // 章节内容
    chapterDetails: function chapterDetails() {
      return _store.default.state.chapterDetails;
    },
    // 章节内容转换
    chapterDetailsConver: function chapterDetailsConver() {
      try {
        // 暂时想不到其他法子，先把\n|\r转成<p>标签
        return (this.chapterDetails.cpContent || this.chapterDetails.body).replace(/\n|\r/g, '<p>');
      } catch (e) {
        return '';
      }
    },
    // 章节目录分段范围
    // ['1-100','101-200',....]
    chapterSectionArray: function chapterSectionArray() {
      var _this = this;
      var totalArrayCount = Math.ceil(this.chaptersSectionCount / _constants.CHAPTER_SECTION_COUNT);
      return Array.from({
        length: totalArrayCount
      }).map(function (section, index) {
        return "".concat(index * _constants.CHAPTER_SECTION_COUNT + 1, " - ").concat(Math.min((index + 1) * _constants.CHAPTER_SECTION_COUNT, _this.chaptersSectionCount));
      });
    }
  },
  watch: {
    showFooterBar: function showFooterBar(value) {
      if (!value) {
        this.showSettingPanel = false;
      }
    },
    isKeepLight: function isKeepLight(value) {
      wx.setKeepScreenOn({
        keepScreenOn: value
      });
    },
    // 监听showDirectory变化，需要重新计算currentChapterSectionIndex，并还原
    showDirectory: function showDirectory(value) {
      // 只在展示的时候还原
      if (value) {
        this.currentChapterSectionIndex = Math.floor(this.currentPageIndex / _constants.CHAPTER_SECTION_COUNT);
      } else {
        // 只在关闭的时候隐藏底部操作栏
        this.showFooterBar = false;
      }
    },
    // 监听当前章节段落序号，改变章节段落
    currentChapterSectionIndex: function currentChapterSectionIndex(value) {
      this.currentChapterSection = _chaptersSection[value];
    }
  },
  methods: {
    // 回首页
    gotoHome: function gotoHome() {
      wx.redirectTo({
        url: '/pages/index/main'
      });
    },
    // 跳转哪一章
    gotoTargeChapter: function gotoTargeChapter(index) {
      this.showDirectory = false;
      this.showFooterBar = false;
      this.currentPageIndex = +index;
      // 先清空章节内容
      _store.default.dispatch('resetChapterDetails');
      var chapter = _chapterListData.chapters[index];
      if (chapter) {
        chapter._index = index;
        _store.default.dispatch('fetchChapterDetails', chapter.link).then(function () {
          wx.pageScrollTo({
            scrollTop: 0,
            duration: 300
          });
        });
        // 更改titleBar文案
        wx.setNavigationBarTitle({
          title: chapter.title
        });
        if (this.bookInBookCase) {
          _store.default.dispatch('addToBookCase', _objectSpread(_objectSpread({}, this.bookInBookCase), {}, {
            currentChapter: chapter,
            __order: false // 倒序插入
          }));
        }
      }
    },
    gotoTargeChapterFromItem: function gotoTargeChapterFromItem(item, index) {
      // 计算将要跳往哪一章
      // eslint-disable-next-line
      var targetChapterIndex = this.currentChapterSectionIndex * _constants.CHAPTER_SECTION_COUNT + Number(index);
      this.gotoTargeChapter(targetChapterIndex);
    },
    onPageClick: function onPageClick() {
      // 切换底部显示
      this.showFooterBar = !this.showFooterBar;
    },
    // 切换目录
    toggleCategoryList: function toggleCategoryList() {
      this.showDirectory = !this.showDirectory;
    },
    // 切换夜间/白天模式
    toggleNightOrDay: function toggleNightOrDay() {
      this.isNightMode = !this.isNightMode;
    },
    // 切换设置面板
    toggleSettingPanel: function toggleSettingPanel() {
      this.showSettingPanel = !this.showSettingPanel;
    },
    // 跳转换源页面
    gotoSourcePage: function gotoSourcePage(bookId) {
      this.showFooterBar = false;
      // 如果没有加入书架，不允许换源
      if (!this.bookInBookCase) {
        wx.showToast({
          title: '加入书架才能换源哦~',
          icon: 'none',
          duration: 2000
        });
      } else {
        wx.navigateTo({
          url: "/pages/source?bookId=".concat(bookId)
        });
      }
    },
    // 改变亮度
    changeLightNess: function changeLightNess(e) {
      var value = e.target.value;
      if (typeof value === 'number') {
        this.lightness = value;
        wx.setScreenBrightness({
          value: value
        });
      }
    },
    // 改变字体大小
    changeFontSize: function changeFontSize(e) {
      var value = e.target.value;
      if (typeof value === 'number') {
        this.chapterFontSize = value;
        wx.setStorage({
          key: _constants.CHAPTER_FONT_SIZE,
          data: value
        });
      }
    },
    // 保持屏幕常亮
    toggleScreenLight: function toggleScreenLight(e) {
      var value = e.target.value;
      this.isKeepLight = value;
      wx.setStorage({
        key: _constants.SCREEN_IS_LIGHT,
        data: value
      });
    },
    // 章节序列切换区间
    chapterSectionArrayChange: function chapterSectionArrayChange(e) {
      this.currentChapterSectionIndex = e.target.value;
    }
  },
  onLoad: function onLoad() {
    var _this2 = this;
    // 更改titleBar标题
    wx.setNavigationBarColor({
      frontColor: '#ffffff',
      backgroundColor: '#333333',
      animation: {
        duration: 150,
        timingFunc: 'easeIn'
      }
    });
    // 获取屏幕亮度
    wx.getScreenBrightness({
      success: function success(_ref) {
        var value = _ref.value;
        if (typeof value === 'number') {
          _this2.lightness = value;
        }
      }
    });
    // 是否常亮
    wx.getStorage({
      key: _constants.SCREEN_IS_LIGHT,
      success: function success(_ref2) {
        var data = _ref2.data;
        _this2.isKeepLight = data;
      }
    });
    // 获取之前设置的字体大小
    wx.getStorage({
      key: _constants.CHAPTER_FONT_SIZE,
      success: function success(_ref3) {
        var data = _ref3.data;
        _this2.chapterFontSize = data;
      }
    });
    // 获取书架数据
    _store.default.dispatch('getBookCase');
    var from = this.$root.$mp.query.from;
    // 如果是从其他地方跳转过来的，比如，分享页
    if (from) {
      this.fromOtherPlace = true;
    }
  },
  onShow: function onShow() {
    var _this3 = this;
    var _this$$root$$mp$query = this.$root.$mp.query,
      bookId = _this$$root$$mp$query.bookId,
      sourceId = _this$$root$$mp$query.sourceId,
      chapterIndex = _this$$root$$mp$query.chapterIndex,
      from = _this$$root$$mp$query.from;
    this.bookInBookCase = this.bookCase.find(function (book) {
      return book._id === bookId;
    });
    var bookInBookCase = this.bookInBookCase; // eslint-disable-line
    // 如果重新进来的时候，当前小说是否跟hide之前一致的，一致就不重新获取
    // 什么时候不一致？当更改书源的时候
    if (_lastChapter && (0, _isEqual.default)(bookInBookCase, _lastChapter)) {
      return;
    }
    _lastChapter = bookInBookCase;
    if (bookId) {
      _store.default.dispatch('fetchBookSource', bookId).then(function (result) {
        // 默认拿第一个书源
        var source = result[0];
        // 如果是从分享页进来的
        if (from === 'share' && sourceId) {
          source = result.find(function (r) {
            return r._id === sourceId;
          }) || source;
        } else if (bookInBookCase && bookInBookCase.currentSource) {
          source = bookInBookCase.currentSource;
        }
        // 只在当前页面临时保存书源
        _currentSource = source;
        return _store.default.dispatch('fetchChapterList', source._id);
      }).then(function (result) {
        _chapterListData = result;
        // 只保留必要的属性，减少数据量
        _chapterListData.chapters = (0, _utils.keepUsefulAttributeInArray)(_chapterListData.chapters, ['_index', 'link', 'title', 'id']);
        // 给章节分段
        _chaptersSection = (0, _chunk2.default)(_chapterListData.chapters, _constants.CHAPTER_SECTION_COUNT);
        _this3.currentChapterSection = _chaptersSection[_this3.currentChapterSectionIndex];
        // 章节ID
        _this3.chapterListDataId = _chapterListData._id;
        // 章节数量
        _this3.chaptersSectionCount = _chapterListData.chapters.length;

        // 默认第一章
        var chapter = result.chapters[0];
        /* eslint-disable */
        // 如果是从分享页进来的
        if (from === 'share' && chapterIndex) {
          _this3.currentPageIndex = +chapterIndex;
          chapter = result.chapters[+chapterIndex];
        }
        // 如果已收藏，本地有数据的话
        else if (bookInBookCase && bookInBookCase.currentChapter && bookInBookCase.currentChapter._index) {
          var _index = bookInBookCase.currentChapter._index;
          // 如果之前的章节比现在书源的总章节还要大, 则最大不能超过该书源的总章节
          if (_index > result.chapters.length - 1) {
            _index = result.chapters.length - 1;
          }
          _this3.currentPageIndex = _index;
          chapter = result.chapters[_index];
        }
        /* eslint-enable */
        // 更改titleBar文案
        wx.setNavigationBarTitle({
          title: chapter.title
        });
        _store.default.dispatch('fetchChapterDetails', chapter.link);
      });
    }
  },
  onHide: function onHide() {
    this.showDirectory = false;
    this.showFooterBar = false;
  },
  // 分享
  onShareAppMessage: function onShareAppMessage() {
    var _ref4 = this.bookInBookCase || this.bookDetails,
      title = _ref4.title,
      _id = _ref4._id,
      cover = _ref4.cover;
    var chapterTitle = (0, _get2.default)(this.chapterDetails, 'title');
    // 有的小说获取到的title是字符串的点.，此时拿书架保存的当前章节的title
    if (chapterTitle.length <= 1) {
      chapterTitle = (0, _get2.default)(_chapterListData.chapters[this.currentPageIndex], 'title');
    }
    return {
      title: "".concat(title, " - ").concat(chapterTitle, "\u2014\u2014Deny\u9605\u8BFB"),
      path: "/pages/chapter?from=share&bookId=".concat(_id, "&sourceId=").concat(_currentSource._id, "&chapterIndex=").concat(this.currentPageIndex),
      imageUrl: (0, _utils.getImgSrc)(cover)
    };
  },
  onUnload: function onUnload() {
    this.showDirectory = false;
    this.showFooterBar = false;
    this.currentPageIndex = 0;
    this.currentChapterSectionIndex = 0;
    _currentSource = null;
    _lastChapter = null;
  }
};
/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/wx.js */ 1)["default"]))

/***/ }),

/***/ 309:
/*!*****************************************************************************************!*\
  !*** ./src/pages/chapter.vue?vue&type=style&index=0&id=11aa2564&lang=scss&scoped=true& ***!
  \*****************************************************************************************/
/*! no static exports found */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
__webpack_require__.r(__webpack_exports__);
/* harmony import */ var _node_modules_vue_cli_service_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_vue_cli_service_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_5_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! -!../../node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--9-oneOf-1-2!../../node_modules/postcss-loader/src??ref--9-oneOf-1-3!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--9-oneOf-1-5!../../node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chapter.vue?vue&type=style&index=0&id=11aa2564&lang=scss&scoped=true& */ 310);
/* harmony import */ var _node_modules_vue_cli_service_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_vue_cli_service_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_5_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_node_modules_vue_cli_service_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_vue_cli_service_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_5_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__);
/* harmony reexport (unknown) */ for(var __WEBPACK_IMPORT_KEY__ in _node_modules_vue_cli_service_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_vue_cli_service_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_5_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__) if(["default"].indexOf(__WEBPACK_IMPORT_KEY__) < 0) (function(key) { __webpack_require__.d(__webpack_exports__, key, function() { return _node_modules_vue_cli_service_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_vue_cli_service_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_5_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0__[key]; }) }(__WEBPACK_IMPORT_KEY__));
 /* harmony default export */ __webpack_exports__["default"] = (_node_modules_vue_cli_service_node_modules_mini_css_extract_plugin_dist_loader_js_ref_9_oneOf_1_0_node_modules_vue_cli_service_node_modules_css_loader_dist_cjs_js_ref_9_oneOf_1_1_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_loaders_stylePostLoader_js_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_2_node_modules_postcss_loader_src_index_js_ref_9_oneOf_1_3_node_modules_dcloudio_vue_cli_plugin_uni_packages_sass_loader_dist_cjs_js_ref_9_oneOf_1_4_node_modules_dcloudio_vue_cli_plugin_uni_packages_webpack_preprocess_loader_index_js_ref_9_oneOf_1_5_node_modules_dcloudio_vue_cli_plugin_uni_packages_vue_loader_lib_index_js_vue_loader_options_node_modules_dcloudio_webpack_uni_mp_loader_lib_style_js_chapter_vue_vue_type_style_index_0_id_11aa2564_lang_scss_scoped_true___WEBPACK_IMPORTED_MODULE_0___default.a); 

/***/ }),

/***/ 310:
/*!*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@vue/cli-service/node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!./node_modules/@vue/cli-service/node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--9-oneOf-1-2!./node_modules/postcss-loader/src??ref--9-oneOf-1-3!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--9-oneOf-1-4!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--9-oneOf-1-5!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./src/pages/chapter.vue?vue&type=style&index=0&id=11aa2564&lang=scss&scoped=true& ***!
  \*********************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

// extracted by mini-css-extract-plugin
    if(false) { var cssReload; }
  

/***/ })

},[[301,"common/runtime","common/vendor"]]]);
//# sourceMappingURL=../../.sourcemap/mp-weixin/pages/chapter.js.map